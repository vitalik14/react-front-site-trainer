import React from 'react';
import { PropTypes } from 'prop-types';
import IconButton from '@material-ui/core/IconButton';
import MenuIcon from '@material-ui/icons/Menu';
import CloseIcon from '@material-ui/icons/Close';
import SearchIcon from '@material-ui/icons/Search';

import Breadcrumbs from './Breadcrumbs/Breadcrumbs';
import Notifications from './Notifications/Notifications';
import notification from './notificationModel';
import styles from './Header.scss';
import {
  StyledAppBar,
  StyledInput,
  StyledCollapse,
  HamburgerIconButton,
  OpaqueFontIcon,
} from './customizedMaterialComponents';

const Header = ({
  baseDomain,
  currentPath,
  commonData,
  isFetchingNotifications,
  notifications,
  notificationsCount,
  unreadNotificationsCount,
  notificationsCurrentPage,
  canPaginateNotifications,
  isSearchFieldExpanded,
  isNotificationsPopoverShown,
  onNotificationItemClick,
  onReadAllNotificationsClick,
  getNotifications,
  isSidebarExpanded,
  toggleSidebarExpansionState,
  onSearchBtnClick,
  onNotificationsBtnClick,
  onNotificationsPopoverOutsideClick,
  isMarkingAllNotificationsAsRead,
  onSearchRequest,
  isTabletOrMobile,
}) => (
  <StyledAppBar component="div" style={isSidebarExpanded ? {} : { left: 0, width: '100%' }}>
    <div className={styles.hamburgerIconCont}>
      <HamburgerIconButton color="inherit" aria-label="Menu" onClick={() => toggleSidebarExpansionState(!isSidebarExpanded)} component={isSidebarExpanded ? CloseIcon : MenuIcon} />
    </div>
    <div className={styles.innerCont}>
      <a href={baseDomain} className={styles.logoCont}>
        <svg width={74} height={24} viewBox="0 0 74 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlnsXlink="http://www.w3.org/1999/xlink">
          <g stroke="none" strokeWidth="1" fill="none" fillRule="evenodd">
            <g transform="translate(-331.000000, -18.000000)" fill="#fff">
              <g transform="translate(310.000000, 0.000000)">
                <path d="M27.0830669,23.4067584 C29.8747437,23.4067584 31.0517898,23.9674537 32.2520103,25.0888611 C33.5808257,26.3304192 34.2559396,27.9424181 34.2773721,29.9249061 C34.2773721,31.9274193 33.6022582,33.5494306 32.2520103,34.7909887 C31.0089248,35.9123961 29.5461781,36.4680852 27.8637263,36.4580726 C26.1812744,36.44806 24.6863794,35.8222841 23.3789965,34.5807259 L23.3789965,40.8585732 C23.3789965,41.1789753 23.2664775,41.4493105 23.0414361,41.669587 C22.8163948,41.8898634 22.5324183,42 22.1894982,42 C21.8465781,42 21.5626016,41.8898634 21.3375603,41.669587 C21.112519,41.4493105 21,41.1789753 21,40.8585732 L21,25.2991239 C21,24.7284105 24.2913901,23.4067584 27.0830669,23.4067584 Z M23.3789965,32.5081352 C24.5792169,33.7496933 25.972309,34.3604507 27.5583145,34.3404255 C29.5729703,34.3404255 30.9124819,33.509395 31.5768896,31.8473091 C31.7912147,31.2866055 31.8876596,30.6458109 31.866227,29.9249061 C31.866227,28.5231469 31.4697316,27.4217812 30.6767288,26.620776 C29.9051585,25.8798461 28.3904498,25.4192741 27.0830669,25.4192741 C25.4970613,25.4192741 24.1224259,25.8798461 23.3789965,26.620776 L23.3789965,32.5081352 Z M42.0563203,34.3704631 C43.5994609,34.3704631 45.0461334,33.5894947 46.3963814,32.0275344 L46.3963814,24.6382979 C46.3963814,24.3379209 46.5089004,24.0775981 46.7339417,23.8573217 C46.9589831,23.6370452 47.2429595,23.5269086 47.5858797,23.5269086 C47.9073673,23.5269086 48.1859857,23.632039 48.4217433,23.8423029 C48.6575009,24.0525668 48.7753779,24.3178958 48.7753779,24.6382979 L48.7753779,35.1814768 C48.7753779,35.5018789 48.6628589,35.7722142 48.4378176,35.9924906 C48.2127762,36.2127671 47.9287998,36.3229036 47.5858797,36.3229036 C47.264392,36.3229036 46.9857736,36.2127671 46.750016,35.9924906 C46.5142585,35.7722142 46.3963814,35.5018789 46.3963814,35.1814768 L46.3963814,34.1902378 C45.6891087,34.8710923 45.0782914,35.3516882 44.5639112,35.6320401 C43.5780158,36.1727186 42.6296416,36.4430538 41.71876,36.4430538 C40.8078784,36.4430538 40.0577519,36.3128924 39.468358,36.0525657 C38.878964,35.792239 38.3913818,35.4518169 38.0055966,35.0312891 C37.1911613,34.1301582 36.7839498,32.9987552 36.7839498,31.6370463 L36.7839498,24.6382979 C36.7839498,24.3379209 36.8964688,24.0775981 37.1215101,23.8573217 C37.3465514,23.6370452 37.6305279,23.5269086 37.973448,23.5269086 C38.2949357,23.5269086 38.5735541,23.632039 38.8093117,23.8423029 C39.0450692,24.0525668 39.1629463,24.3178958 39.1629463,24.6382979 L39.1629463,31.3667084 C39.1629463,32.2878644 39.3879842,33.0187708 39.8380669,33.5594493 C40.2881495,34.1001279 41.02756,34.3704631 42.0563203,34.3704631 Z M54.5932615,25.0888611 C55.8363469,23.546926 57.1373644,23.5269086 58.6590725,23.5269086 C59.3758966,23.5269086 60.0015067,23.6470588 60.1071842,24.2616655 C60.2128616,24.8762722 59.8503186,25.2290353 59.614561,25.4192741 C59.4573893,25.5460999 59.1388931,25.4845808 58.6590725,25.2347167 C57.7803397,25.2347167 56.8094863,25.464992 56.123646,25.8654947 C55.4378058,26.2659973 55.0647766,26.6107603 54.5932615,27.2515645 L54.5932615,35.2115144 C54.5932615,35.5118914 54.4753844,35.7722142 54.2396269,35.9924906 C54.0038693,36.2127671 53.7252509,36.3229036 53.4037632,36.3229036 C53.0822756,36.3229036 52.8036572,36.2127671 52.5678996,35.9924906 C52.332142,35.7722142 52.214265,35.5118914 52.214265,35.2115144 L52.214265,24.6683354 C52.214265,24.3679584 52.326784,24.1026294 52.5518253,23.8723404 C52.7768667,23.6420514 53.0608431,23.5269086 53.4037632,23.5269086 C53.7252509,23.5269086 54.0038693,23.6370452 54.2396269,23.8573217 C54.3967986,24.0041726 54.5146768,24.4146858 54.5932615,25.0888611 Z M61.8578321,19.2315394 C61.8578321,18.9111373 61.9757091,18.6458083 62.2114667,18.4355444 C62.4472243,18.2252806 62.7365588,18.1201502 63.0794789,18.1201502 C63.422399,18.1201502 63.7063755,18.2252806 63.9314168,18.4355444 C64.1564582,18.6458083 64.2689771,18.9111373 64.2689771,19.2315394 L64.2689771,35.2115144 C64.2689771,35.5118914 64.1564582,35.7722142 63.9314168,35.9924906 C63.7063755,36.2127671 63.422399,36.3229036 63.0794789,36.3229036 C62.7365588,36.3229036 62.4472243,36.2127671 62.2114667,35.9924906 C61.9757091,35.7722142 61.8578321,35.5118914 61.8578321,35.2115144 L61.8578321,19.2315394 Z M67.9972017,24.6683354 C67.9972017,24.3279082 68.1150787,24.0525668 68.3508363,23.8423029 C68.5865939,23.632039 68.8759284,23.5269086 69.2188485,23.5269086 C69.5617686,23.5269086 69.8403871,23.632039 70.0547121,23.8423029 C70.2690372,24.0525668 70.3761981,24.3279082 70.3761981,24.6683354 L70.3761981,35.2115144 C70.3761981,35.5118914 70.2690372,35.7722142 70.0547121,35.9924906 C69.8403871,36.2127671 69.5617686,36.3229036 69.2188485,36.3229036 C68.8759284,36.3229036 68.5865939,36.2127671 68.3508363,35.9924906 C68.1150787,35.7722142 67.9972017,35.5118914 67.9972017,35.2115144 L67.9972017,24.6683354 Z M70.6333869,19.8322904 C70.6333869,20.1927427 70.5047938,20.4931152 70.2476037,20.7334168 C69.9904136,20.9737183 69.6689308,21.0938673 69.2831457,21.0938673 L69.1224027,21.0938673 C68.7366176,21.0938673 68.4204928,20.9737183 68.174019,20.7334168 C67.9275451,20.4931152 67.8043101,20.1927427 67.8043101,19.8322904 L67.8043101,19.7421777 C67.8043101,19.3817254 67.9329032,19.0813529 68.1900933,18.8410513 C68.4472834,18.6007497 68.7580501,18.4806008 69.1224027,18.4806008 L69.2831457,18.4806008 C69.6689308,18.4806008 69.9904136,18.6007497 70.2476037,18.8410513 C70.5047938,19.0813529 70.6333869,19.3817254 70.6333869,19.7421777 L70.6333869,19.8322904 Z M81.0946679,20.2828536 C80.4372896,19.9524406 79.8871312,19.787234 79.4441927,19.787234 C78.779785,19.787234 78.0980447,19.8595764 77.7766219,20.2828536 C77.4551991,20.7061307 77.3192827,21.4342886 77.3192827,22.2953692 L77.3192827,23.6470588 L80.6305886,23.6470588 C80.9306437,23.6470588 81.1771139,23.7371706 81.3700064,23.9173967 C81.562899,24.0976229 81.6593438,24.3279085 81.6593438,24.6082603 C81.6593438,24.8886122 81.557541,25.1188977 81.3539321,25.2991239 C81.1503233,25.4793501 80.9092112,25.5694618 80.6305886,25.5694618 L77.3192827,25.5694618 L77.3192827,35.2115144 C77.3192827,35.5118914 77.2067638,35.7722142 76.9817224,35.9924906 C76.7566811,36.2127671 76.4727046,36.3229036 76.1297845,36.3229036 C75.7868644,36.3229036 75.5028879,36.2127671 75.2778466,35.9924906 C75.0528053,35.7722142 74.9402863,35.5118914 74.9402863,35.2115144 L74.9402863,25.5694618 L73.3650049,25.5694618 C73.0649497,25.5694618 72.8184796,25.4793501 72.625587,25.2991239 C72.4326945,25.1188977 72.3362496,24.8886122 72.3362496,24.6082603 C72.3362496,24.3279085 72.4380525,24.0976229 72.6416613,23.9173967 C72.8452702,23.7371706 73.0863823,23.6470588 73.3650049,23.6470588 L74.9402863,23.6470588 L74.9402863,22.2052566 C74.9402863,20.7834722 75.36893,19.6921189 76.2262303,18.931164 C76.9335031,18.3103849 77.8122227,18 78.8624156,18 C79.6768509,18 80.9306386,18.1601986 81.6593438,18.4806008 C82.0665615,18.6808521 82.2006105,18.9311625 82.2006105,19.2315394 C82.2006105,19.5319164 81.9948296,19.7822268 81.8019371,19.9824781 C81.6090445,20.1827294 81.3732905,20.2828536 81.0946679,20.2828536 Z M84.8410422,30.7359199 C84.9910697,31.8373021 85.4465037,32.7133885 86.2073577,33.3642053 C86.9682117,34.015022 88.0183888,34.3404255 89.3579206,34.3404255 C90.6974523,34.3404255 91.8387162,34.1401772 92.7817465,33.7396746 C93.0818017,33.5994987 93.349704,33.5244056 93.5854616,33.514393 C93.8212192,33.5043804 94.4359517,34.2387831 94.4359517,34.4590595 C94.4359517,34.8996124 94.362388,35.1214009 93.9873191,35.301627 C93.6122502,35.4818532 93.2746933,35.6420519 92.9746382,35.7822278 C92.674583,35.9224037 92.3531003,36.0425527 92.0101801,36.1426783 C91.2171773,36.3429297 90.2955933,36.4430538 89.2454005,36.4430538 C87.0807172,36.4430538 85.4036486,35.8773523 84.2141445,34.7459324 C83.0246403,33.6145125 82.4298971,32.0075198 82.4298971,29.9249061 C82.4298971,28.1226443 82.9335535,26.620782 83.9408813,25.4192741 C85.0768043,24.0775903 86.6735021,23.4067584 88.7310229,23.4067584 C90.7028136,23.4067584 92.2566471,24.0275282 93.39257,25.2690864 C94.4641953,26.430544 95,27.8823442 95,29.6245307 C95,29.9249076 94.887481,30.1852304 94.6624397,30.4055069 C94.4373984,30.6257833 94.1534219,30.7359199 93.8105018,30.7359199 L84.8410422,30.7359199 Z M88.7310229,25.2991239 C87.1664498,25.2991239 86.0305439,25.9499309 85.3232712,27.2515645 C85.0660811,27.7121425 84.9053397,28.2628253 84.8410422,28.9036295 L92.6210035,28.9036295 C92.556706,27.7421719 92.095914,26.8210297 91.2386137,26.1401752 C90.5527735,25.5794715 89.7169182,25.2991239 88.7310229,25.2991239 Z" />
              </g>
            </g>
          </g>
        </svg>
      </a>
      <Breadcrumbs baseDomain={baseDomain} currentPath={currentPath} />
    </div>
    <div className={styles.innerCont}>
      <IconButton color="inherit">
        <OpaqueFontIcon />
      </IconButton>
      <StyledCollapse in={isSearchFieldExpanded && !isTabletOrMobile}>
        <StyledInput placeholder="Search..." disableUnderline className={styles.input} onKeyUp={event => onSearchRequest(event, baseDomain)} />
      </StyledCollapse>
      <IconButton onClick={onSearchBtnClick} color="inherit" style={{ display: isTabletOrMobile ? 'none' : 'inline-flex' }}>
        <SearchIcon />
      </IconButton>
      <Notifications
        commonData={commonData}
        handleNotificationsPopoverClose={onNotificationsPopoverOutsideClick}
        handleNotificationsBtnClick={onNotificationsBtnClick}
        isNotificationsPopoverShown={isNotificationsPopoverShown}
        isFetchingNotifications={isFetchingNotifications}
        notifications={notifications}
        notificationsCount={notificationsCount}
        unreadNotificationsCount={unreadNotificationsCount}
        notificationsCurrentPage={notificationsCurrentPage}
        canPaginateNotifications={canPaginateNotifications}
        onNotificationItemClick={onNotificationItemClick}
        onReadAllNotificationsClick={onReadAllNotificationsClick}
        getNotifications={getNotifications}
        isMarkingAllNotificationsAsRead={isMarkingAllNotificationsAsRead}
      />
    </div>
  </StyledAppBar>
);

Header.propTypes = {
  baseDomain: PropTypes.string.isRequired,
  currentPath: PropTypes.string.isRequired,
  commonData: PropTypes.shape({
    unreadNotifications: PropTypes.number,
    unreadMessages: PropTypes.number,
    friendshipRequests: PropTypes.number,
  }).isRequired,
  isFetchingNotifications: PropTypes.bool.isRequired,
  notifications: PropTypes.objectOf(PropTypes.shape(notification)).isRequired,
  notificationsCount: PropTypes.number.isRequired,
  unreadNotificationsCount: PropTypes.string.isRequired,
  notificationsCurrentPage: PropTypes.number.isRequired,
  canPaginateNotifications: PropTypes.bool.isRequired,
  isSearchFieldExpanded: PropTypes.bool.isRequired,
  isNotificationsPopoverShown: PropTypes.bool.isRequired,
  onSearchBtnClick: PropTypes.func.isRequired,
  onNotificationsBtnClick: PropTypes.func.isRequired,
  onNotificationsPopoverOutsideClick: PropTypes.func.isRequired,
  onNotificationItemClick: PropTypes.func.isRequired,
  onReadAllNotificationsClick: PropTypes.func.isRequired,
  getNotifications: PropTypes.func.isRequired,
  isMarkingAllNotificationsAsRead: PropTypes.bool.isRequired,
  isSidebarExpanded: PropTypes.bool,
  toggleSidebarExpansionState: PropTypes.func.isRequired,
  onSearchRequest: PropTypes.func.isRequired,
  isTabletOrMobile: PropTypes.bool.isRequired,
};

Header.defaultProps = {
  isSidebarExpanded: null,
};

export default Header;
